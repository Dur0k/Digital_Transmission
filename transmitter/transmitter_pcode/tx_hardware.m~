function x = tx_hardware(s,par_txthresh,switch_graph)
%TX_HARDWARE models the influences from an amplifier on the baseband signal
%by the hard thresholding.
%
%   x = tx_hardware(s,par_txthresh,switch_graph)
%
%   The non-linear behavior is modeled by a linear input and output
%   relation for the absolute value of s up to par_txthresh and 1 for
%   otherwise.
%
%   Switchable graph to draw the output of the non-linear hardware with
%   On:  switch_graph = 1;
%   Off: switch_graph = 0;
%

    x = zeros(length(s),1);
    % Go through every value of s and check if its abs is 
    for i = 1:length(s)
        s_abs = abs(s(i));
        if (s_abs > 1)
            s(i) = s(i)/s_abs;
        end
    end
    x = s;
    
    if switch_graph == 1
        figure('Name','Hardware','Numbertitle','off');
        suptitle('Signal nach dem Sendeverstärker');
        subplot(2,1,1);
        stem(real(x))
        xlabel('t');
        ylabel('Realteil');
        
        subplot(2,1,2);
        stem(imag(x))
        xlabel('t');
        ylabel('Imaginärteil');
    end
end